# 缓存
>以redis为主

## 基础

### 数据结构

### redis内存淘汰策略
>Redis的内存淘汰策略是指在Redis的用于缓存的内存不足时，怎么处理需要新写入且需要申请额外空间的数据。

>1，noeviction：当内存不足以容纳新写入数据时，新写入操作会报错。
>2，allkeys-lru：当内存不足以容纳新写入数据时，在键空间中，移除最近最少使用的key。
>3，allkeys-random：当内存不足以容纳新写入数据时，在键空间中，随机移除某个key。
>4，volatile-lru：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，移除最近最少使用的key。
>5，volatile-random：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，随机移除某个key。
>6，volatile-ttl：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，有更早过期时间的key优先移除。

### redis内存过期策略
>1，定时过期：每个设置过期时间的key都需要创建一个定时器，到过期时间就会立即清除。该策略可以立即清除过期的数据，对内存很友好；但是会占用大量的CPU资源去处理过期的数据，从而影响缓存的响应时间和吞吐量。
>2，惰性过期：只有当访问一个key时，才会判断该key是否已过期，过期则清除。该策略可以最大化地节省CPU资源，却对内存非常不友好。极端情况可能出现大量的过期key没有再次被访问，从而不会被清除，占用大量内存。
>3，定期过期：每隔一定的时间，会扫描一定数量的数据库的expires字典中一定数量的key，并清除其中已过期的key。该策略是前两者的一个折中方案。通过调整定时扫描的时间间隔和每次扫描的限定耗时，可以在不同情况下使得CPU和内存资源达到最优的平衡效果。
(expires字典会保存所有设置了过期时间的key的过期时间数据，其中，key是指向键空间中的某个键的指针，value是该键的毫秒精度的UNIX时间戳表示的过期时间。键空间是指该Redis集群中保存的所有键。)

## 问题与解决方案

### 缓存雪崩
>大量数据同时失效
>随机过期时间

### 缓存穿透
>数据在缓存中不存在即没有命中，同时在数据库中也不存在
>1，将无效的key存入redis，2，使用布隆过滤器

### 缓存击穿
>热点key失效，导致数据库高并发
>热点数据不过期

### 缓存与数据库一致性问题


### 缓存预热


### 缓存降级：
>缓存降级是指缓存失效或缓存服务器挂掉的情况下，不去访问数据库，直接返回默认数据或访问服务的内存数据。降级一般是有损的操作，所以尽量减少降级对于业务的影响程度

## 架构及可能存在的问题

### 主从

### 环形架构？